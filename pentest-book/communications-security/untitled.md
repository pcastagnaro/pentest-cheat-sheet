# SSL/TLS

## Audit SSL/TLS

### SSLscan

<pre class="language-bash" data-overflow="wrap" data-line-numbers data-full-width="false"><code class="lang-bash"><strong># Single Host
</strong>sslscan --show-ciphers --no-failed --show-certificate --xml=sslscan_out.xml &#x3C;HOST>:&#x3C;PORT>

# Target List
sslscan --show-ciphers --no-failed --show-certificate --xml=sslscan_out.xml --targets=targetlist.txt
</code></pre>

One-line command:

<pre class="language-bash" data-overflow="wrap" data-line-numbers><code class="lang-bash"># Single Host
<strong>domain=domain.com; sslscan --show-ciphers --no-failed --show-certificate --xml="${domain}".sslscan_out.xml "${domain}":&#x3C;PORT>
</strong></code></pre>

### TLSled

{% code overflow="wrap" lineNumbers="true" fullWidth="false" %}
```bash
tlssled <IP> <PORT>
```
{% endcode %}

### SSLyze

{% code overflow="wrap" lineNumbers="true" fullWidth="false" %}
```bash
sslyze --http_headers --json_out=File.json <HOST>:<PORT>
```
{% endcode %}

One-line command:

{% code overflow="wrap" lineNumbers="true" %}
```bash
domain=domain.com; sslyze --http_headers --regular --json_out="${domain}".json "${domain}":<PORT>
```
{% endcode %}

## SSLlabs

[https://www.ssllabs.com/ssltest/index.html](https://www.ssllabs.com/ssltest/index.html)

### SSLscan

{% code overflow="wrap" lineNumbers="true" fullWidth="false" %}
```bash
# Single Host
sslscan --show-ciphers --no-failed --show-certificate --xml=sslscan_out.xml <HOST>:<PORT>

# Target List
sslscan --show-ciphers --no-failed --show-certificate --xml=sslscan_out.xml --targets=targetlist.txt
```
{% endcode %}

### TLSed

{% code overflow="wrap" lineNumbers="true" fullWidth="false" %}
```bash
tlssled <IP> <PORT>
```
{% endcode %}

### SSLyze

{% code overflow="wrap" lineNumbers="true" fullWidth="false" %}
```bash
sslyze --http_headers --regular --json_out=File.json <HOST>:<PORT>
```
{% endcode %}

### SSLlabs

[https://www.ssllabs.com/ssltest/index.html](https://www.ssllabs.com/ssltest/index.html)

## HSTS

### Nmap

{% code overflow="wrap" lineNumbers="true" fullWidth="false" %}
```bash
nmap -p 443 --script http-hsts-verify -Pn -v -oA http-hsts-verify <TARGET>
```
{% endcode %}

### Curl

{% code overflow="wrap" lineNumbers="true" fullWidth="false" %}
```bash
curl -I -k https://xxx.xxx.com
```
{% endcode %}

{% hint style="danger" %}
cURL should show a header like `Strict-Transport-Security: max-age=15552000; preload`
{% endhint %}

## POODLE

### Nmap

{% code overflow="wrap" lineNumbers="true" %}
```bash
nmap -sV --version-light --script ssl-poodle -p <PORT> <TARGET>
```
{% endcode %}

{% hint style="info" %}
More Info: http://nmap.org/nsedoc/scripts/ssl-poodle.html
{% endhint %}

## SSL DROWN

{% tabs %}
{% tab title="Nmap" %}
```bash
nmap -sV --script=sslv2-drown -p 443 -Pn -v -oA sslv2-drown <TARGET>
```
{% endtab %}
{% endtabs %}

## HEARTBLEED

{% tabs %}
{% tab title="Nmap" %}
```bash
nmap --script ssl-heartbleed --script-args vulns.showall -oA ssl-heartbleed -Pn -p <PORT> -sV <TARGET>
```
{% endtab %}
{% endtabs %}

{% hint style="info" %}
More Info:

* https://gist.github.com/bonsaiviking/10402038
* http://nmap.org/nsedoc/scripts/ssl-heartbleed.html
{% endhint %}

## Get Certificates

{% tabs %}
{% tab title="Nmap" %}
```bash
nmap -sV -sC -vv -oA certificadosSSL -Pn -p 443 <target>
```
{% endtab %}

{% tab title="OpenSSL" %}
```bash
openssl s_client -connect <TARGET>:<PORT>
```
{% endtab %}

{% tab title="Bash" %}
```bash
echo | openssl s_client --showcerts --connect <target:port> | awk 'BEGIN{p="openssl x509 -noout -text"} {print |p} /-----END/{close(p)}'
```
{% endtab %}
{% endtabs %}

{% hint style="info" %}
More info: https://nmap.org/nsedoc/scripts/ssl-cert.html
{% endhint %}

## Enum Ciphers

{% tabs %}
{% tab title="Nmap" %}
```bash
nmap --script ssl-enum-ciphers -Pn -p 443 -oA ssl-enum-ciphers <TARGET>
```
{% endtab %}
{% endtabs %}

{% hint style="info" %}
More Info: http://nmap.org/nsedoc/scripts/ssl-enum-ciphers.html
{% endhint %}

### SSLv2

{% tabs %}
{% tab title="Nmap" %}
```bash
nmap -v -sV -sC <TARGET>
```
{% endtab %}

{% tab title="SSLyze" %}
```bash
sslyze --sslv2 --json_out=output.json HOST:PORT
```
{% endtab %}
{% endtabs %}

{% hint style="info" %}
More info: https://nmap.org/nsedoc/scripts/sslv2.html
{% endhint %}

## Sweet32

{% tabs %}
{% tab title="Nmap" %}
```bash
nmap --script ssl-enum-ciphers -p <PORT> <TARGET>
```
{% endtab %}
{% endtabs %}

![](../../.gitbook/assets/5.png)

{% tabs %}
{% tab title="YAWAST" %}
```bash
sudo docker pull adamcaudill/yawast && sudo docker run --rm adamcaudill/yawast scan https://www.domain.com --tdessessioncount
```
{% endtab %}
{% endtabs %}

{% hint style="info" %}
This is the recommended option, especially if you need to perform the SWEET32 test (`--tdessessioncount`), due to OpenSSL dropping support for the 3DES cipher suites.

In this case I’m using YAWAST to run a ssl scan, using the `--tdessessioncount` parameter to instruct YAWAST to perform the SWEET32 test. In this case, you can see that the TLS session was ended after 100 requests (Connection terminated after 100 requests (TLS Reconnected)) – which is a clear indication that the server isn’t vulnerable.
{% endhint %}

![](../../.gitbook/assets/6.png)

_Had the server actually been vulnerable, this message would have been displayed:_

_**\[V] TLS Session Request Limit: Connection not terminated after 10,000 requests; possibly vulnerable to SWEET32**_
