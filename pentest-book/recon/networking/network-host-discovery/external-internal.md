---
icon: right-from-bracket
cover: >-
  https://images.unsplash.com/photo-1542382257-80dedb725088?crop=entropy&cs=srgb&fm=jpg&ixid=M3wxOTcwMjR8MHwxfHNlYXJjaHwxfHxuZXR3b3JrfGVufDB8fHx8MTcyNjEzNDk4Nnww&ixlib=rb-4.0.3&q=85
coverY: 0
---

# External/Internal

## Nmap

{% hint style="success" %}
For [Nmap Docker](external-internal.md#nmap-docker)
{% endhint %}

{% hint style="success" %}
Nmap to Markdown: [Nmap2md](https://app.gitbook.com/o/5S34jejP8cj7fWWt6R2a/s/-Lt8335BPUBXjq3iC572/pentest-book/parsing-reporting/parsing#nmap2md)
{% endhint %}

### Network Discovery with scripts

{% code overflow="wrap" lineNumbers="true" %}
```bash
sudo nmap -sS -Pn -sV -v --top-ports 8000 --min-parallelism 20 --min-hostgroup 30 --max-rtt-timeout 300ms --max-retries 2 -oA SYN_8K_ports --script default,discovery,broadcast --open-only -iL ip_hostname.txt
```
{% endcode %}

{% hint style="info" %}
**`--script=default:`** Runs a set of default scripts that are commonly used for network discovery and general scanning. It includes basic checks for services, OS detection, and some vulnerability checks.

* **`broadcast`** category: These scripts are designed for discovering hosts and services by broadcasting requests across the network.
* **`discovery`** category: These scripts are more specific to discovering information about the network.

**`-sV`**: Detects the version of services running on open ports.

**`--open-only`** report only open ports, not closed ports.
{% endhint %}

### Ping Discovery

{% code overflow="wrap" lineNumbers="true" %}
```bash
sudo nmap -PE -PP -PM --min-parallelism 20 --min-hostgroup 30 --max-rtt-timeout 30ms --max-retries 2 -A -oA HostDiscoveryMultpleICMP Network
```
{% endcode %}

{% hint style="info" %}
**`-PE`** Use ICMP Echo Request

**`-PP`** Use ICMP Timestamp Request

**`-PM`** Use ICMP Netmask Request
{% endhint %}

***

### Nmap Docker

Using the [https://hub.docker.com/r/instrumentisto/nmap](https://hub.docker.com/r/instrumentisto/nmap)

{% code overflow="wrap" lineNumbers="true" %}
```bash
docker run --rm -it -v "C:\localFolder\nmap:/output" instrumentisto/nmap <NMAP PARAMETERS> -oA /output/<OUTPUT NAME> <DOMAIN/S>
```
{% endcode %}

***

## sn1per

**Repository:** [https://github.com/1N3/Sn1per](https://github.com/1N3/Sn1per)

**Info:** Automated Pentest Recon Scanner

### **DISCOVER**

Parses all hosts on a subnet/CIDR (ie. `192.168.0.0/16`) and initiates a sniper scan against each host. Useful for internal network scans.

```
sudo sniper -t <CIDR> -m discover -w <WORSPACE_ALIAS>
sudo sniper -t www.domain.com -m discover -w workspace_name
```

### **AIRSTRIKE**

Quickly enumerates open ports/services on multiple hosts and performs basic fingerprinting. To use, specify the full location of the file which contains all hosts, IPs that need to be scanned and run `./sn1per /full/path/to/targets.txt` airstrike to begin scanning.

{% code overflow="wrap" lineNumbers="true" %}
```bash
sudo sniper -f /full/path/to/targets.txt -m airstrike
sudo sniper -t domain.com | <CIDR> -m discover -w domain && sudo sniper -f /usr/share/sniper/loot/domain/lyse/domains/targets.txt -m airstrike
```
{% endcode %}

![sn1per in Airstrike mode](<../../../../.gitbook/assets/image (41).png>)

***

## HackerTarget Tools

**Repo:** [https://hackertarget.com/ip-tools/](https://hackertarget.com/ip-tools/)

**Info:** The following are a collection of online IP Tools that can be used to quickly get information about IP Addresses, Web Pages and DNS records.

These tools are placed here to be a quick reference whether you are assessing your organizations systems, or popping boxes on a penetration testing engagement.
