---
icon: arrows-to-circle
cover: >-
  https://images.unsplash.com/photo-1639322537228-f710d846310a?crop=entropy&cs=srgb&fm=jpg&ixid=M3wxOTcwMjR8MHwxfHNlYXJjaHw1fHxuZXR3b3JrfGVufDB8fHx8MTcyNjEzNDk4Nnww&ixlib=rb-4.0.3&q=85
coverY: 0
---

# Internal only

## ARP Scan

```
arp-scan --interface=wlan0 --localnet
arp-scan --interface=wlan0 10.0.1.0/24
```

More Info:

* [https://www.blackmoreops.com/2015/12/31/use-arp-scan-to-find-hidden-devices-in-your-network/](https://www.blackmoreops.com/2015/12/31/use-arp-scan-to-find-hidden-devices-in-your-network/)
* [https://tools.kali.org/information-gathering/arp-scan](https://tools.kali.org/information-gathering/arp-scan)

***

## NetDiscover

{% code overflow="wrap" lineNumbers="true" %}
```bash
netdiscover -i wlan0 -r range
```
{% endcode %}

{% hint style="info" %}
`-r range`: scan a given range instead of auto scan. 192.168.6.0/24,/16,/8
{% endhint %}

{% code overflow="wrap" lineNumbers="true" %}
```bash
netdiscover -i wlan0 -p -f -P -L
```
{% endcode %}

{% hint style="info" %}
`-P` print results in a format suitable for parsing by another program and stop after active scan

`-L` similar to `-P` but continue listening after the active scan is completed

`-f` enable fastmode scan, saves a lot of time, recommended for auto

`-p` passive mode: do not send anything, only sniff
{% endhint %}

***

## SMB security level

{% code overflow="wrap" lineNumbers="true" %}
```bash
nmap --script smb-security-mode.nse -p 445 <PORT> <TARGET>
```
{% endcode %}

{% code overflow="wrap" lineNumbers="true" %}
```bash
nmap -sU -sS --script smb-security-mode.nse -p U:137,T:139,445
```
{% endcode %}

{% code overflow="wrap" lineNumbers="true" %}
```bash
nmap -p445 --script smb-protocols <TARGET>
```
{% endcode %}



{% hint style="info" %}
Info: [http://nmap.org/nsedoc/scripts/smb-security-mode.html](http://nmap.org/nsedoc/scripts/smb-security-mode.html)
{% endhint %}

***

### NetBIOS Scanner

NetBIOS Scanner: [http://www.nirsoft.net/utils/netbios\_scanner.html](http://www.nirsoft.net/utils/netbios\_scanner.html)

### Nmap nbstat

{% code overflow="wrap" lineNumbers="true" %}
```bash
nmap -sU --script nbstat.nse -p137 <host>
```
{% endcode %}



{% hint style="info" %}
[https://nmap.org/nsedoc/scripts/nbstat.html](https://nmap.org/nsedoc/scripts/nbstat.html)
{% endhint %}

### Metasploit

* use auxiliary/scanner/smb/smb\_version
* use auxiliary/scanner/smb/smb\_enumshares
* use auxiliary/scanner/smb/smb\_lookupsid
* use auxiliary/scanner/smb/smb\_enumusers

***

## Enumerate SMB resources

{% code overflow="wrap" lineNumbers="true" %}
```bash
nmap -sU -sS --script smb-enum-shares.nse -p U:137,T:139,445
```
{% endcode %}
