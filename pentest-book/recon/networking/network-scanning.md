# Network Scanning

## Masscan

### Scan Networks

{% code overflow="wrap" lineNumbers="true" %}
```bash
sudo masscan 172.16.0.0/16,10.32.0.0/16,10.200.0.0/16 -p 21,22,23,25,100-700,3389,8080 --banners -e eth0 --open-only --max-rate 10000 -oG output-file.grepable
```
{% endcode %}

{% code overflow="wrap" lineNumbers="true" %}
```bash
sudo masscan 10.6.66.40 10.6.104.191 10.11.119.9 10.6.67.21 -p 21,22,23,25,100-700,3389,8080 --banners -e cscotun0 --open-only --max-rate 100 -oG output-file.grepable
```
{% endcode %}

{% hint style="info" %}
`--banners` specifies that banners should be grabbed, like HTTP server versions, HTML title fields, and so forth. Only a few protocols are supported.

`--open-only` report only open ports, not closed ports.
{% endhint %}

### Scan Specific Hosts

**Masscan** only accepts **IP addresses** and does not support **hostnames** in its input list. If your input file contains hostnames (like `example.com`), that will cause an error, as Masscan cannot resolve them automatically.

You’ll need to resolve the hostnames into IP addresses before running the Masscan scan. Here’s how you can do that:

#### **Resolve Hostnames to IPs** (Linux example)

You can use tools like `nslookup`, `dig`, or `host` to resolve hostnames into IP addresses.

#### **Automating the Process with a Script:**

If you have many hostnames, you can write a simple script to resolve them into IP addresses and output a clean list.

Here’s a bash script to do that:

{% code title="resolve_ips.sh" overflow="wrap" lineNumbers="true" %}
```bash
#!/bin/bash

# Check if an input file was provided
if [ $# -ne 2 ]; then
    echo "Usage: $0 <hostname_file> <output_file>"
    exit 1
fi

input_file="$1"
output_file="$2"

# Empty the output file if it already exists
> "$output_file"

# Read each line from the input file
while IFS= read -r line; do
    # Skip empty lines
    if [[ -z "$line" ]]; then
        continue
    fi

    # Check if the line is an IP address
    if [[ $line =~ ^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+$ ]]; then
        echo "$line" >> "$output_file"
    else
        # Resolve the hostname to an IP
        ip=$(nslookup "$line" | grep 'Address:' | tail -n 1 | awk '{ print $2 }')
        if [[ -n $ip ]]; then
            echo "$ip" >> "$output_file"
        else
            echo "Failed to resolve $line" >&2
        fi
    fi
done < "$input_file"

echo "Resolved IPs saved to $output_file"

```
{% endcode %}

#### How to Use the Script:

1.  **Save the script as `resolve_ips.sh`**:

    ```bash
    nano resolve_ips.sh
    ```
2.  **Make it executable**:

    ```bash
    chmod +x resolve_ips.sh
    ```
3.  **Run the script with your hostname list file as a parameter**:

    ```bash
    ./resolve_ips.sh hostnames.txt resolved_ips.txt
    ```

* This script now takes the file `hostnames.txt` (or any other file you provide as a parameter) and resolves the hostnames into IPs.
* The output will be saved to `resolved_ips.txt.`

#### Run the Scan

{% code overflow="wrap" lineNumbers="true" %}
```bash
sudo masscan -iL <hosts.txt> -p 21,22,23,25,100-700,3389,8080 --banners --open-only --max-rate 100 -oG <output-file.grepable>
```
{% endcode %}

{% hint style="info" %}
`--banners` specifies that banners should be grabbed, like HTTP server versions, HTML title fields, and so forth. Only a few protocols are supported.

`--open-only` report only open ports, not closed ports.
{% endhint %}

***

## Zmap

```
zmap -p 445 -o output-file 172.16.0.0/16 10.32.0.0/16 10.200.0.0/16
```
